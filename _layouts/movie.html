<!DOCTYPE html>
<html>
{% include head.html %}
<body>
    {% include masthead.html %}
    <section class="main">
        {% assign mydata = site.data.movie-ratings %}
        {% if page.dataset == "movies" %}
        {% assign mydata = (site.data.movie-ratings | sort:'Rating') | reverse %}
        {% elsif page.dataset == "tv shows" %}
        {% assign mydata = (site.data.tv-ratings | sort:'Rating') | reverse %}
        {% endif %}

        <p class="total">Total {{ page.dataset }}: {{ mydata.size }}</p>

        <p class="filter-wrap"><input type="text" id="filter" onkeyup="filter()" placeholder="Search..." /></p>

        <div class="list">
            {% assign lastRating = " 6" %}
            {% for row in mydata %}
                {% assign currentRating = row.Rating %}
                {% if row.Rating == " 1" %}
                    {% assign ratingValue = "Hated" %}
                {% elsif row.Rating == " 2" %}
                    {% assign ratingValue = "Disliked" %}
                {% elsif row.Rating == " 3" %}
                    {% assign ratingValue = "Average" %}
                {% elsif row.Rating == " 4" %}
                    {% assign ratingValue = "Liked" %}
                {% elsif row.Rating == " 5" %}
                    {% assign ratingValue = "Loved" %}
                {% elsif row.Rating == " 6" %}
                    {% assign ratingValue = "Godtier" %}
                {% endif %}
                {% if lastRating != row.Rating %}
                    <div class="break"></div>
                    {% assign lastRating = row.Rating %}
                {% endif %}
                <div class="item rating-{{ row.Rating | strip }}">
                    <span class="name">{{ row.Name }}</span>
                    <span class="rating">{{ ratingValue }}</span>
                </div>
            {% endfor %}
        </div>
    </section>

    <script>
        function filter() {
            const filterValue = document.getElementById('filter').value.toUpperCase();
            const items = document.getElementsByClassName('item');

            for (i = 0; i < items.length; i++) {
                const item = items[i].children[0].textContent || items[i].children[0].innerText;
                if (item.toUpperCase().indexOf(filterValue) > -1) {
                    items[i].style.display = "";
                } else {
                    items[i].style.display = "none";
                }
            }
        }
    </script>
</body>
</html>